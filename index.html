<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord 로그인 및 나이 인증하기</title>
    <style>
        .hidden {
            display: none;
        }
    </style>
    <script>
        const clientId = '952929327006220299'; // Discord 개발자 포털에서 가져온 클라이언트 ID
        const redirectUri = encodeURIComponent('https://dlvmserverdlswmd.netlify.app/callback'); // 콜백 URL

        function loginWithDiscord() {
            const scope = 'identify%20guilds'; // 필요한 권한 범위
            window.location.href = `https://discord.com/api/oauth2/authorize?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=code&scope=${scope}`;
        }

        function showAgeVerification() {
            document.getElementById('login-section').classList.add('hidden');
            document.getElementById('age-verification-section').classList.remove('hidden');
        }

        function verifyAge() {
            // 여기에 나이 인증 로직을 구현합니다.
            alert('나이 인증이 완료되었습니다. 채널에 접근할 수 있습니다.');
        }

        function handleCallback() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            if (code) {
                // 여기서 서버에 코드를 전송하여 액세스 토큰을 얻을 수 있습니다.
                console.log('인증 코드:', code);
                showAgeVerification();
            }
        }

        window.onload = function() {
            if (window.location.pathname === '/callback') {
                handleCallback();
            }
        }
    </script>
</head>
<body>
    <div id="login-section">
        <h1>인증 전 로그인해주세요.</h1>
        <p>로그인하려면 아래 버튼을 클릭하세요.</p>
        <button onclick="loginWithDiscord()">Discord로 로그인</button>
    </div>

    <div id="age-verification-section" class="hidden">
        <h1>채널을 볼려면 pass로 나이인증을 해주세요</h1>
        <button onclick="verifyAge()">인증하기</button>
    </div>
</body>
</html>
